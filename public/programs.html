<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>EquaNova - Programs</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

  <!-- Navigation -->
  <nav>
    <div class="logo">EquaNova</div>
    <ul class="nav-links">
      <li><a href="index.html">Home</a></li>
      <li><a href="programs.html">Programs</a></li>
    </ul>
    <div class="auth-buttons">
      <a href="login.html" class="btn primary-btn">Log In</a>
      <a href="signup.html" class="btn secondary-btn">Sign Up</a>
    </div>
  </nav>

  <!-- Programs Section -->
  <section class="programs-section">
    <h2>Available Programs</h2>
    <p>Verified opportunities directly from our partners.</p>
    <div id="programs">
      <p id="status-text">⏳ Waking up server… please wait.</p>
    </div>
  </section>

  <!-- JavaScript to fetch and display programs -->
  <script>
    const BASE_URL = "YOUR_RENDER_URL_HERE"; // Replace with your Render backend URL
    const API_URL = BASE_URL + "/api/programs";
    const container = document.getElementById("programs");
    const statusText = document.getElementById("status-text");

    async function fetchPrograms(retries = 5, delay = 4000) {
      try {
        const response = await fetch(API_URL);
        if (!response.ok) throw new Error("Server not ready yet");

        const program = await response.json();
        renderProgram(program);
      } catch (err) {
        if (retries > 0) {
          statusText.textContent = "⏳ Waking up server… retrying, please wait.";
          setTimeout(() => fetchPrograms(retries - 1, delay), delay);
        } else {
          statusText.textContent = "⚠️ Server is taking longer than usual. Please refresh the page.";
        }
      }
    }

    function renderProgram(program) {
      container.innerHTML = ""; // clear status/loading text
      const card = document.createElement("div");
      card.className = "program-card";
      card.innerHTML = `
        <h3>${program.name}</h3>
        <p><strong>Provider:</strong> ${program.provider}</p>
        <p><strong>Level:</strong> ${program.level}</p>
        <p><strong>Field:</strong> ${program.field}</p>
        <p><strong>Country:</strong> ${program.country}</p>
        <p>
          <strong>Website:</strong>
          <a href="${program.website}" target="_blank">${program.website}</a>
        </p>
        <p><strong>Verified:</strong> ${program.verified ? "✅ Yes" : "❌ No"}</p>
      `;
      container.appendChild(card);
    }

    // Initial fetch
    fetchPrograms();
  </script>

</body>
</html>
